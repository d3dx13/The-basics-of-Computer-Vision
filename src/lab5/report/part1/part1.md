### –õ–∏—Å—Ç–∏–Ω–≥ 1. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –•–∞—Ñ–∞

–ò–¥–µ—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –•–∞—Ñ–∞ (–∞–Ω–≥–ª. Hough, –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–µ—Ä–µ–≤–æ–¥–∞ –•–æ—Ö, –•–æ) –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø–æ–∏—Å–∫–µ –æ–±—â–∏—Ö –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö
–º–µ—Å—Ç —Ç–æ—á–µ–∫ (–ì–ú–¢). –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏
–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –ø–æ —Ç—Ä–µ–º –∑–∞–¥–∞–Ω–Ω—ã–º —Å—Ç–æ—Ä–æ–Ω–∞–º, –∫–æ–≥–¥–∞ —Å–Ω–∞—á–∞–ª–∞ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –æ–¥–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞, –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∫–æ–Ω—Ü—ã –æ—Ç—Ä–µ–∑–∫–∞ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –∫–∞–∫ —Ü–µ–Ω—Ç—Ä—ã –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–µ–π —Ä–∞–¥–∏—É—Å–∞–º–∏
—Ä–∞–≤–Ω—ã–º–∏ –¥–ª–∏–Ω–∞–º –≤—Ç–æ—Ä–æ–≥–æ –∏ —Ç—Ä–µ—Ç—å–µ–≥–æ –æ—Ç—Ä–µ–∑–∫–æ–≤. –ú–µ—Å—Ç–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è
–¥–≤—É—Ö –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–µ–π —è–≤–ª—è–µ—Ç—Å—è –æ–±—â–∏–º –ì–ú–¢, –æ—Ç–∫—É–¥–∞ –∏ –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è –æ—Ç—Ä–µ–∑–∫–∏ –¥–æ –∫–æ–Ω—Ü–æ–≤ –ø–µ—Ä–≤–æ–≥–æ –æ—Ç—Ä–µ–∑–∫–∞. –ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å,
—á—Ç–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –¥–≤—É—Ö —Ç–æ—á–µ–∫ –≤ –ø–æ–ª—å–∑—É –≤–µ—Ä–æ—è—Ç–Ω–æ–≥–æ
—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è —Ç—Ä–µ—Ç—å–µ–π –≤–µ—Ä—à–∏–Ω—ã —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ ¬´–≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è¬ª ¬´–ø–æ–±–µ–¥–∏–ª–∞¬ª —Ç–æ—á–∫–∞, –Ω–∞–±—Ä–∞–≤—à–∞—è –¥–≤–∞ ¬´–≥–æ–ª–æ—Å–∞¬ª (—Ç–æ—á–∫–∏ –Ω–∞
–æ–∫—Ä—É–∂–Ω–æ—Å—Ç—è—Ö –Ω–∞–±—Ä–∞–ª–∏ –ø–æ –æ–¥–Ω–æ–º—É –≥–æ–ª–æ—Å—É, –∞ –≤–Ω–µ –∏—Ö ‚Äî –ø–æ –Ω—É–ª—é).

–û–±–æ–±—â–∏–º –¥–∞–Ω–Ω—É—é –∏–¥–µ—é –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –∫–æ–≥–¥–∞
–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –∏–º–µ–µ—Ç—Å—è –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å–æ–±—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–æ—á–µ–∫, —É—á–∞—Å—Ç–≤—É—é—â–∏—Ö –≤ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–∏. –î–æ–ø—É—Å—Ç–∏–º, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
–Ω–∞–π—Ç–∏ –≤ –±–∏–Ω–∞—Ä–Ω–æ–º —Ç–æ—á–µ—á–Ω–æ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ —Ä–∞–¥–∏—É—Å–∞ ùëÖ, –ø—Ä–∏—á–µ–º –≤ –¥–∞–Ω–Ω–æ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ –º–æ–≥—É—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∏ –ª–æ–∂–Ω—ã–µ —Ç–æ—á–∫–∏, –Ω–µ –ª–µ–∂–∞—â–∏–µ –Ω–∞ –∏—Å–∫–æ–º–æ–π –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏. –ù–∞–±–æ—Ä —Ü–µ–Ω—Ç—Ä–æ–≤
–≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–µ–π –∏—Å–∫–æ–º–æ–≥–æ —Ä–∞–¥–∏—É—Å–∞ –≤–æ–∫—Ä—É–≥ –∫–∞–∂–¥–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—á–∫–∏ –æ–±—Ä–∞–∑—É–µ—Ç –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å —Ä–∞–¥–∏—É—Å–∞ R

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ç–æ—á–∫–∞, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—é —á–∏—Å–ª–∞ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–µ–π, –∏ –±—É–¥–µ—Ç —è–≤–ª—è—Ç—å—Å—è —Ü–µ–Ω—Ç—Ä–æ–º –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏ –∏—Å–∫–æ–º–æ–≥–æ —Ä–∞–¥–∏—É—Å–∞.

–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –•–∞—Ñ–∞, –±–∞–∑–∏—Ä—É—é—â–µ–µ—Å—è –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–π –∏–¥–µ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è —Ç–æ—á–µ–∫, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –±—ã–ª–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ
–¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø—Ä—è–º—ã—Ö –Ω–∞ –±–∏–Ω–∞—Ä–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö. –í –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –•–∞—Ñ–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –°–∞–º—ã–º —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –ø—Ä—è–º—ã—Ö —è–≤–ª—è–µ—Ç—Å—è:

ùë¶ = ùëòùë• + ùëè, (1)

ùë• cos Œò + ùë¶ sin Œò = ùúå (2)

–≥–¥–µ 
ùúå ‚Äî —Ä–∞–¥–∏—É—Å-–≤–µ–∫—Ç–æ—Ä, –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–π –∏–∑ –Ω–∞—á–∞–ª–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–æ –ø—Ä—è–º–æ–π; 
Œò ‚Äî —É–≥–æ–ª –Ω–∞–∫–ª–æ–Ω–∞ —Ä–∞–¥–∏—É—Å-–≤–µ–∫—Ç–æ—Ä–∞.

–ü—É—Å—Ç—å –≤ –¥–µ–∫–∞—Ä—Ç–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø—Ä—è–º–∞—è –∑–∞–¥–∞–Ω–∞ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º (1), –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –ª–µ–≥–∫–æ –≤—ã—á–∏—Å–ª–∏—Ç—å —Ä–∞–¥–∏—É—Å-–≤–µ–∫—Ç–æ—Ä ùúå –∏ —É–≥–æ–ª
Œò (2). –¢–æ–≥–¥–∞ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –•–∞—Ñ–∞ –ø—Ä—è–º–∞—è –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ —Ç–æ—á–∫–æ–π —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (ùúå0,Œò0)

–ü–æ–¥—Ö–æ–¥ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –•–∞—Ñ–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—É–º–º–∏—Ä—É–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ—Å–æ–≤, –ø–æ–¥–∞–Ω–Ω—ã—Ö –∑–∞ –Ω–µ–µ, –ø–æ—ç—Ç–æ–º—É –≤ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–º –≤–∏–¥–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
–•–∞—Ñ–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–æ–º –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–µ–∫–æ—Ç–æ—Ä—É—é –º–∞—Ç—Ä–∏—Ü—É ùê¥(ùúå,Œò), —Ö—Ä–∞–Ω—è—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–∏. –ß–µ—Ä–µ–∑ –∫–∞–∂–¥—É—é —Ç–æ—á–∫—É –≤ –¥–µ–∫–∞—Ä—Ç–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏
–±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ —á–∏—Å–ª–æ –ø—Ä—è–º—ã—Ö, —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ—Ä–æ–¥–∏—Ç –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç–∫–ª–∏–∫–∞. –¢–∞–∫–∏–º
–æ–±—Ä–∞–∑–æ–º, –ª—é–±—ã–µ –¥–≤–µ —Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–∫–ª–∏–∫–∞ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–µ—Ä–µ—Å–µ–∫—É—Ç—Å—è –≤ —Ç–æ—á–∫–µ (ùúå,Œò) —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ,
–µ—Å–ª–∏ –ø–æ—Ä–æ–∂–¥–∞—é—â–∏–µ –∏—Ö —Ç–æ—á–∫–∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ª–µ–∂–∞—Ç –Ω–∞ –ø—Ä—è–º–æ–π. –ò—Å—Ö–æ–¥—è –∏–∑ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ
–¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –ø—Ä—è–º—ã–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –≤—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –º–∞–∫—Å–∏–º—É–º—ã –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞.

–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –ø—Ä—è–º—ã—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–∞–∫–∏–º –∂–µ
–æ–±—Ä–∞–∑–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –ø–æ–∏—Å–∫–∞ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –∫—Ä–∏–≤–æ–π, –æ–ø–∏—Å—ã–≤–∞–µ–º–æ–π –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –Ω–µ–∫–æ—Ç–æ—Ä–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —á–∏—Å–ª–æ–º
–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ùêπ = (ùëé1,ùëé2,...,ùëéùëõ,ùë•,ùë¶), —á—Ç–æ –ø–æ–≤–ª–∏—è–µ—Ç –ª–∏—à—å –Ω–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º –•–∞—Ñ–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–µ–π –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–¥–∏—É—Å–∞ ùëÖ. –ò–∑–≤–µ—Å—Ç–Ω–æ,
—á—Ç–æ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Ñ–æ—Ä–º—É–ª–æ–π (ùë• ‚àí ùë•0)^2 + (ùë¶ ‚àí ùë¶0)^2 = ùëÖ^2. –ù–∞–±–æ—Ä —Ü–µ–Ω—Ç—Ä–æ–≤ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–µ–π —Ä–∞–¥–∏—É—Å–∞ ùëÖ, –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö —á–µ—Ä–µ–∑ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫—É—é —Ç–æ—á–∫—É, –æ–±—Ä–∞–∑—É–µ—Ç
–æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å —Ä–∞–¥–∏—É—Å–∞ ùëÖ –≤–æ–∫—Ä—É–≥ —ç—Ç–æ–π —Ç–æ—á–∫–∏, –ø–æ—ç—Ç–æ–º—É —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–∫–ª–∏–∫–∞ –≤ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –•–∞—Ñ–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–µ–π 
–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å —Ç–∞–∫–æ–≥–æ –∂–µ —Ä–∞–∑–º–µ—Ä–∞ —Å —Ü–µ–Ω—Ç—Ä–æ–º –≤ –≥–æ–ª–æ—Å—É—é—â–µ–π —Ç–æ—á–∫–µ.
–¢–æ–≥–¥–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —Å–ª—É—á–∞—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –º–∞–∫—Å–∏–º—É–º—ã –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ ùê¥(ùë•,ùë¶) –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ
–ø–∞—Ä–∞–º–∞–µ—Ç—Ä–æ–≤ (ùë•,ùë¶), –∫–æ—Ç–æ—Ä—ã–µ –∏ –±—É–¥—É—Ç —è–≤–ª—è—Ç—å—Å—è —Ü–µ–Ω—Ç—Ä–∞–º–∏ –∏—Å–∫–æ–º—ã—Ö
–æ–∫—Ä—É–∂–Ω–æ—Å—Ç–µ–π.

–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –•–∞—Ñ–∞ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ –∫ —Å–¥–≤–∏–≥—É, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é
–∏ –ø–æ–≤–æ—Ä–æ—Ç—É. –£—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ –ø—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è—Ö —Ç—Ä–µ—Ö–º–µ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø—Ä—è–º—ã–µ –ª–∏–Ω–∏–∏ –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç —Ç–æ–ª—å–∫–æ –≤
–ø—Ä—è–º—ã–µ –ª–∏–Ω–∏–∏ (–≤ –≤—ã—Ä–æ–∂–¥–µ–Ω–Ω–æ–º —Å–ª—É—á–∞–µ ‚Äî –≤ —Ç–æ—á–∫–∏), –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –•–∞—Ñ–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –ª–∏–Ω–∏–∏ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ –Ω–µ —Ç–æ–ª—å–∫–æ –∫
–∞—Ñ—Ñ–∏–Ω–Ω—ã–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è–º –ø–ª–æ—Å–∫–æ—Å—Ç–∏, –Ω–æ –∏ –∫ –≥—Ä—É–ø–ø–µ –ø—Ä–æ–µ–∫—Ç–∏–≤–Ω—ã—Ö
–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.

### –õ–∏—Å—Ç–∏–Ω–≥ 1.1 –ü–æ–∏—Å–∫ –ø—Ä—è–º—ã—Ö –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –•–∞—Ñ–∞


```python
import cv2
import os
import skimage.filters
import skimage.transform
import skimage.morphology
import numpy as np
from matplotlib import pyplot as plt
from matplotlib.pyplot import figure
import warnings
warnings.filterwarnings('ignore')
export_parallel = True
use_graph = True
```


```python
# –ò—Å—Ö–æ–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –ª–∏–Ω–∏—è–º–∏
images = [cv2.cvtColor(cv2.imread(f"data/lines/{image_path}"), cv2.COLOR_BGR2GRAY) for image_path in os.listdir("data/lines")]

# –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ –≤—ã–±–æ—Ä–∞ –ø–∏–∫–∞ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –•–∞—Ñ–∞ –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω threshold_ku[i] * (–º–∞–∫—Å–∏–º—É–º –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –•–∞—Ñ–∞)
threshold_ku = [0.5 for i in range(len(images))] # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å 0.5 —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ skimage
threshold_ku[-1] = 0.38
threshold_ku[-2] = 0.45

# –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ª–∏–Ω–∏–∏ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –•–∞—Ñ–∞
line_length = [100 for i in range(len(images))]
line_length[-1] = 20
```


```python
if use_graph:
    for image in images:
        figure(figsize=(32, 16), dpi=80)
        plt.imshow(cv2.cvtColor(image, cv2.COLOR_GRAY2RGB))
        plt.xticks([]),plt.yticks([])
        plt.show()
```


    
![png](output_3_0.png)
    



    
![png](output_3_1.png)
    



    
![png](output_3_2.png)
    



    
![png](output_3_3.png)
    



    
![png](output_3_4.png)
    



```python
# –ü–æ–∏—Å–∫ –ø—Ä—è–º—ã—Ö —á–µ—Ä–µ–∑ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –•–∞—Ñ–∞ –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
if use_graph:
    hough_line = []
    for image in images:
        angle_step_deg = 0.1
        tested_angles = np.linspace(- np.pi / 2, np.pi / 2, int(round(360 / angle_step_deg)), endpoint=False)
        hough, theta, d = skimage.transform.hough_line(image, theta=tested_angles)
        hough_line.append((hough, theta, d))
```


```python
# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞ –•–∞—Ñ–∞.
if use_graph:
    for hough in hough_line:
        fig = figure(figsize=(16, 9), dpi=80)
        angle_step = 0.5 * np.diff(hough[1]).mean()
        d_step = 0.5 * np.diff(hough[2]).mean()
        bounds = [np.rad2deg(hough[1][0] - angle_step),
                  np.rad2deg(hough[1][-1] + angle_step),
                  hough[2][-1] + d_step, hough[2][0] - d_step]
        plt.imshow(cv2.cvtColor(np.float32(1.0 * hough[0] / np.max(hough[0])), cv2.COLOR_GRAY2RGB), extent=bounds, aspect=0.1)
        plt.title('Hough transform')
        plt.xlabel('Angles (degrees)')
        plt.ylabel('Distance (pixels)')
        plt.show()
```


    
![png](output_5_0.png)
    



    
![png](output_5_1.png)
    



    
![png](output_5_2.png)
    



    
![png](output_5_3.png)
    



    
![png](output_5_4.png)
    


–û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–µ–±—è –ø–æ–∫–∞–∑–∞–ª–∏ —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –±–µ–ª—ã–º —Ü–≤–µ—Ç–æ–º –Ω–∞ —á—ë—Ä–Ω–æ–º —Ñ–æ–Ω–µ 
(–ø–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–∫—Ä–µ—â–∏–≤–∞—é—â–∏—Ö—Å—è –ª–∏–Ω–∏–π –∏ –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —à—Ç—Ä–∏—Ö –∫–æ–¥)

–ù–∞ –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —à—Ç—Ä–∏—Ö –∫–æ–¥–µ –≤–∏–¥–Ω–æ –º–µ—Ç—Å—Ç–æ –Ω–∞–∏–±–æ–ª—å—à–µ–≥–æ —Å–∫–æ–ø–ª–µ–Ω–∏—è –ª–∏–Ω–∏–π –ø–æ–¥ —É–≥–ª–æ–º –æ–∫–æ–ª–æ -45 –≥—Ä–∞–¥—É—Å–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ d, 
—ç—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π —à—Ç—Ä–∏—Ö –∫–æ–¥–∞, –∞ –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 45 –≤–∏–¥–Ω—ã –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏, –ø—Ä–æ—Ö–æ–¥—è—â–∏–µ –≤–¥–æ–ª—å —à—Ç—Ä–∏—Ö –∫–æ–¥–∞.

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å –ø–∏–∫–∏ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞.


```python
# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä—è–º—ã—Ö –≤–Ω—É—Ç—Ä–∏ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞ –•–∞—Ñ–∞.
if use_graph:
    for index in range(len(images)):
        fig = figure(figsize=(16, 9), dpi=80)
        hough, theta, d = hough_line[index]
        image = images[index]
        plt.imshow(cv2.cvtColor(image, cv2.COLOR_GRAY2RGB))
        plt.xticks([]),plt.yticks([])
        for _, angle, dist in zip(
                *skimage.transform.hough_line_peaks(
                hough, 
                theta, 
                d, 
                threshold=threshold_ku[index] * np.max(hough))):
            (x0, y0) = dist * np.array([np.cos(angle), np.sin(angle)])
            plt.axline((x0, y0), slope=np.tan(angle + np.pi/2))
        plt.xlim((image.shape[1], 0))
        plt.ylim((image.shape[0], 0))
        plt.show()
```


    
![png](output_7_0.png)
    



    
![png](output_7_1.png)
    



    
![png](output_7_2.png)
    



    
![png](output_7_3.png)
    



    
![png](output_7_4.png)
    


–ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–µ –ø–æ—Ö–æ–∂–∏—Ö –Ω–∞ –∫–æ–Ω—Ç—É—Ä–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Ö–æ–∂ –±–æ–ª—å—à–µ –Ω–∞ –•–∞–æ—Å, —á–µ–º –Ω–∞ –Ω–∞–±–æ—Ä –ø—Ä—è–º—ã—Ö.


```python
# –ö–æ–Ω—Ç—É—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–µ—Ç–æ–¥–æ–º –ö–µ–Ω–Ω–∏ –∏—Å—Ö–æ–¥–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –ª–∏–Ω–∏—è–º–∏
edges = [cv2.Canny(image, 50, 300) for image in images]
```


```python
if use_graph:
    for image in edges:
        figure(figsize=(32, 16), dpi=80)
        plt.imshow(cv2.cvtColor(image, cv2.COLOR_GRAY2RGB))
        plt.xticks([]),plt.yticks([])
        plt.show()
```


    
![png](output_10_0.png)
    



    
![png](output_10_1.png)
    



    
![png](output_10_2.png)
    



    
![png](output_10_3.png)
    



    
![png](output_10_4.png)
    



```python
# –ü–æ–∏—Å–∫ –ø—Ä—è–º—ã—Ö —á–µ—Ä–µ–∑ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –•–∞—Ñ–∞ –¥–ª—è –∫–æ–Ω—Ç—É—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
if use_graph:
    hough_line = []
    for image in edges:
        angle_step_deg = 0.1
        tested_angles = np.linspace(- np.pi / 2, np.pi / 2, int(round(360 / angle_step_deg)), endpoint=False)
        hough, theta, d = skimage.transform.hough_line(image, theta=tested_angles)
        hough_line.append((hough, theta, d))
```


```python
# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–∏–ª–µ–Ω–Ω–æ–≥–æ –≤ 3 —Ä–∞–∑–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞ –•–∞—Ñ–∞ –¥–ª—è –∫–æ–Ω—Ç—É—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
if use_graph:
    for hough in hough_line:
        fig = figure(figsize=(16, 9), dpi=80)
        angle_step = 0.5 * np.diff(hough[1]).mean()
        d_step = 0.5 * np.diff(hough[2]).mean()
        bounds = [np.rad2deg(hough[1][0] - angle_step),
                  np.rad2deg(hough[1][-1] + angle_step),
                  hough[2][-1] + d_step, hough[2][0] - d_step]
        plt.imshow(cv2.cvtColor(np.float32(3.0 * hough[0] / np.max(hough[0])), cv2.COLOR_GRAY2RGB), extent=bounds, aspect=0.1)
        plt.title('Hough transform')
        plt.xlabel('Angles (degrees)')
        plt.ylabel('Distance (pixels)')
        plt.show()
```

    Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
    


    
![png](output_12_1.png)
    


    Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
    


    
![png](output_12_3.png)
    


    Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
    


    
![png](output_12_5.png)
    


    Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
    


    
![png](output_12_7.png)
    


    Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
    


    
![png](output_12_9.png)
    


–¢–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–µ–¥—É—Ç —Å–µ–±—è –≤—Å–µ –ø–∏–∫–∏.

–ò–∑ 1 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –•–∞—Ñ–∞ –æ—á–µ–≤–∏–¥–Ω–æ –Ω–∞–ª–∏—á–∏–µ 4 –ø—Ä—è–º—ã—Ö; 

–∏–∑ 2 –∏ 3 –Ω–∞–ª–∏—á–∏–µ —Å–∏–ª—å–Ω—ã—Ö –º–Ω–æ–∂–µ—Å—Ç–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä—è–º—ã—Ö —Å —Ä–∞–∑–Ω–∏—Ü–µ–π –≤ –≤—ã—Å–æ—Ç–µ –º–µ–∂–¥—É –Ω–∏–º–∏ –∏ 
–º–µ–Ω–µ–µ —Å–∏–ª—å–Ω–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø—Ä—è–º—ã—Ö –¥—Ä—É–≥ –Ω–∞–¥ –¥—Ä—É–≥–æ–º –±–µ–∑ —Ä–∞–∑–Ω–∏—Ü—ã –≤ –≤—ã—Å–æ—Ç–µ; 

–∏–∑ 4 –Ω–∞–ª–∏—á–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø—Ä—è–º—ã—Ö —Å–æ —Å—Ö–æ–∂–∏–º–∏ 
–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏ –Ω–∞–∫–ª–æ–Ω–∞, –Ω–æ —Ä–∞–∑–Ω—ã–º–∏ –≤—ã—Å–æ—Ç–∞–º–∏ –∏ —Å–∏–ª—å–Ω–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –ø—Ä—è–º—ã—Ö –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω–æ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ 
–º–µ–∂–¥—É —Å–æ–±–æ–π; 

–∏–∑ 5 –≤–∏–¥–Ω–æ –æ–∫–æ–ª–æ 8-12 —è–≤–Ω—ã—Ö –ø–∏–∫–æ–≤ –ª–∏–Ω–∏–π, –∏ –∫–∞–∂–µ—Ç—Å—è –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –•–∞—Ñ–∞ –∏—Ö —Ç–æ—á–∫–∏ –æ–ø–∏—Å—ã–≤–∞—é—Ç —Å–∏–Ω—É—Å–æ–∏–¥—É, –∫–∞–∫ –¥–æ–ª–∂–Ω—ã,
–≤ —Ç–µ–æ—Ä–∏–∏, –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø—Ä—è–º—ã—Ö, –ø—Ä–æ—Ö–æ–¥—ã—â–∏—ä —á–µ—Ä–µ–∑ 1 —Ç–æ—á–∫—É.

–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –Ω–æ –∏–¥–µ—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ –æ–¥–Ω–æ–≥–æ –∏–∑ –µ–≥–æ –º–µ—Ç–æ–¥–æ–≤.


```python
# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä—è–º—ã—Ö –≤–Ω—É—Ç—Ä–∏ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞ –•–∞—Ñ–∞ –¥–ª—è –∫–æ–Ω—Ç—É—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
if use_graph:
    for index in range(len(images)):
        fig = figure(figsize=(16, 9), dpi=80)
        hough, theta, d = hough_line[index]
        image = edges[index]
        plt.imshow(cv2.cvtColor(image, cv2.COLOR_GRAY2RGB))
        plt.xticks([]),plt.yticks([])
        for _, angle, dist in zip(
                *skimage.transform.hough_line_peaks(
                hough, 
                theta, 
                d, 
                threshold=threshold_ku[index] * np.max(hough))):
            (x0, y0) = dist * np.array([np.cos(angle), np.sin(angle)])
            plt.axline((x0, y0), slope=np.tan(angle + np.pi/2))
        plt.xlim((image.shape[1], 0))
        plt.ylim((image.shape[0], 0))
        plt.show()
```


    
![png](output_14_0.png)
    



    
![png](output_14_1.png)
    



    
![png](output_14_2.png)
    



    
![png](output_14_3.png)
    



    
![png](output_14_4.png)
    


–î–ª—è –ø–æ–∏—Å–∫–∞ –∫—Ä–∞—ë–≤ –ª–∏–Ω–∏–π –Ω—É–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è "progressive probabilistic line Hough transform"


```python
if use_graph:
    probabilistic_hough_line = []
    for index, image in enumerate(edges):
        lines = skimage.transform.probabilistic_hough_line(image, line_length = line_length[index], line_gap=3)
        probabilistic_hough_line.append(lines)
```


```python
if use_graph:
    for index in range(len(images)):
        fig = figure(figsize=(16, 9), dpi=80)
        lines = probabilistic_hough_line[index]
        image = edges[index]
        plt.imshow(cv2.cvtColor(image, cv2.COLOR_GRAY2RGB))
        plt.xticks([]),plt.yticks([])
        for line in lines:
            p0, p1 = line
            plt.plot((p0[0], p1[0]), (p0[1], p1[1]))
        plt.xlim((image.shape[1], 0))
        plt.ylim((image.shape[0], 0))
        plt.show()
```


    
![png](output_17_0.png)
    



    
![png](output_17_1.png)
    



    
![png](output_17_2.png)
    



    
![png](output_17_3.png)
    



    
![png](output_17_4.png)
    


–°–ª–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, –∫–∞–∫–∞—è –¥–ª–∏–Ω–∞ —É –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –ª–∏–Ω–∏–π, 
–Ω–æ –º–æ–∂–Ω–æ —Ç–æ—á–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –Ω–∞ –≤—Å–µ—Ö —Ñ–æ—Ç–æ, –∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ, 
–¥–ª–∏–Ω–∞ –ª–∏–Ω–∏–π –±–æ–ª—å—à–µ 100, –∞ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º –±–æ–ª—å—à–µ 20.

–ü—Ä–æ "Generalized Hough Transform" –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ —Ä–∞—Å—Å–∫–∞–∑–∞–Ω–æ —Ç—É—Ç.

https://www.youtube.com/watch?v=_mGxmZWs9Zw


```python

```
