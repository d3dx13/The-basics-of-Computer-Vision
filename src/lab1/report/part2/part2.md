### Ğ›Ğ¸ÑÑ‚Ğ¸Ğ½Ğ³ 2.1. ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ ÑˆÑ‚Ñ€Ğ¸Ñ…-ĞºĞ¾Ğ´Ğ° Ğ²Ğ´Ğ¾Ğ»ÑŒ Ğ¾ÑĞ¸ Ox.

**ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ**

ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ĞµĞ¼ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ²Ğ´Ğ¾Ğ»ÑŒ Ğ½ĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğ¹ Ğ»Ğ¸Ğ½Ğ¸Ğ¸ Ğ½Ğ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ¸Ğ½Ñ‚ĞµĞ½ÑĞ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ, 
Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ´Ğ¾Ğ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ»Ğ¸Ğ½Ğ¸Ğ¸ (Ğ¿Ñ€Ğ¾Ñ€ĞµĞ·ĞºĞ¸). ĞŸÑ€Ğ¾ÑÑ‚ĞµĞ¹ÑˆĞ¸Ğ¼ ÑĞ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ ÑĞ²Ğ»ÑĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ ÑÑ‚Ñ€Ğ¾ĞºĞ¸:

Profile ğ‘–(ğ‘¥) = ğ¼(ğ‘¥,ğ‘–), (1.8)

Ğ³Ğ´Ğµ ğ‘– â€” Ğ½Ğ¾Ğ¼ĞµÑ€ ÑÑ‚Ñ€Ğ¾ĞºĞ¸ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ ğ¼.

ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ ÑÑ‚Ğ¾Ğ»Ğ±Ñ†Ğ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ:

Profile ğ‘—(ğ‘¦) = ğ¼(ğ‘—,ğ‘¦), (1.9)

Ğ³Ğ´Ğµ ğ‘— â€” Ğ½Ğ¾Ğ¼ĞµÑ€ ÑÑ‚Ğ¾Ğ»Ğ±Ñ†Ğ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ ğ¼.

Ğ’ Ğ¾Ğ±Ñ‰ĞµĞ¼ ÑĞ»ÑƒÑ‡Ğ°Ğµ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ñ€Ğ°ÑÑĞ¼Ğ°Ñ‚Ñ€Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ğ²Ğ´Ğ¾Ğ»ÑŒ Ğ»ÑĞ±Ğ¾Ğ¹ Ğ¿Ñ€ÑĞ¼Ğ¾Ğ¹, Ğ»Ğ¾Ğ¼Ğ°Ğ½Ğ¾Ğ¹ Ğ¸Ğ»Ğ¸ ĞºÑ€Ğ¸Ğ²Ğ¾Ğ¹ Ğ»Ğ¸Ğ½Ğ¸Ğ¸, Ğ¿ĞµÑ€ĞµÑĞµĞºĞ°ÑÑ‰ĞµĞ¹ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ.
ĞŸĞ¾ÑĞ»Ğµ Ñ„Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ° Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ²Ğ¾Ğ´Ğ¸Ñ‚ÑÑ ĞµĞ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¼Ğ¸ ÑÑ€ĞµĞ´ÑÑ‚Ğ²Ğ°Ğ¼Ğ¸. 
ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµÑ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ²Ñ‹Ğ´ĞµĞ»ÑÑ‚ÑŒ Ğ¾ÑĞ¾Ğ±Ñ‹Ğµ Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ, ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚ÑƒÑ€Ğ°Ğ¼ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ, 
Ğ¿ĞµÑ€ĞµÑĞµĞºĞ°ĞµĞ¼Ñ‹Ğ¼ Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ»Ğ¸Ğ½Ğ¸ĞµĞ¹.


```python
import cv2
import numpy as np
from numpy.linalg import norm
from matplotlib import pyplot as plt
from matplotlib.pyplot import figure
from numba import njit, jit
from math import *
import imutils
import warnings
from scipy.signal import find_peaks
warnings.filterwarnings('ignore')
export_parallel = True
use_graph = True
```


```python
# Ğ¡Ñ‡Ğ¸Ñ‚Ğ°Ñ Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¹ ÑˆÑ‚Ñ€Ğ¸Ñ… ĞºĞ¾Ğ´ Ğ² Ñ‡Ñ‘Ñ€Ğ½Ğ¾-Ğ±ĞµĞ»Ğ¾Ğ¼ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ.
image = cv2.cvtColor(cv2.imread("data/barcode.png"), cv2.COLOR_BGR2GRAY)
```


```python
# ĞĞ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¹ ÑˆÑ‚Ñ€Ğ¸Ñ… ĞºĞ¾Ğ´
if use_graph:
    figure(figsize=(32, 16), dpi=80)
    plt.imshow(cv2.cvtColor(image, cv2.COLOR_BGR2RGB))
    plt.xticks([]),plt.yticks([])
    plt.show()
```


    
![png](output_4_0.png)
    



```python
# Ğ”Ğ»Ñ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ Ğ±ÑƒĞºĞ²Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ¿Ğ¾ÑÑ‡Ğ¸Ñ‚Ğ°Ñ Ğ¸Ğ½Ñ‚ĞµĞ½ÑĞ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ²Ğ´Ğ¾Ğ»ÑŒ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ»Ğ¸Ğ½Ğ¸Ğ¸.
@njit(parallel=export_parallel)
def improfile(image, profile_line_raw=None, profile_length=None):
    if profile_line_raw is None:
        profile_line = np.array([image.shape[0] / 2.0, 0.0, image.shape[0] / 2.0, 1.0 * image.shape[1]], dtype="float64")
    else:
        profile_line = np.array(profile_line_raw, dtype="float64")
    if profile_length is None:
        profile_length = sqrt(pow(profile_line[2] - profile_line[0], 2.0) + pow(profile_line[3] - profile_line[1], 2.0))
    image -= np.min(image)
    max_intensity = np.max(image)
    intensity = np.zeros((ceil(profile_length), ))
    initial_point = profile_line[0:2]
    vector = (profile_line[2:4] - initial_point)
    for t in range(ceil(profile_length)):
        current_point = initial_point + vector * (1.0 * t / profile_length)
        if current_point[0] > image.shape[0] - 1 or current_point[1] > image.shape[1] - 1 or current_point[0] < 0 or current_point[1] < 0:
            continue
        for x in range(floor(current_point[1]), floor(current_point[1]) + 2):
            for y in range(floor(current_point[0]), floor(current_point[0]) + 2):
                multiplier = (1 - abs(x - current_point[1])) * (1 - abs(y - current_point[0]))
                intensity[t] += (max_intensity - image[y][x]) * multiplier
    return intensity
```


```python
# Ğ’Ñ‹Ğ²ĞµĞ´Ñƒ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ²Ğ´Ğ¾Ğ»ÑŒ Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ»Ğ¸Ğ½Ğ¸Ğ¸.
if use_graph:
    figure(figsize=(16, 12), dpi=80)
    plt.plot(improfile(image))
```


    
![png](output_6_0.png)
    


ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ»Ñ ÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ ÑĞ°Ğ¼Ğ¾Ğ³Ğ¾ ÑˆÑ‚Ñ€Ğ¸Ñ… ĞºĞ¾Ğ´Ğ°, 
Ğ½Ğ¾ Ğ¿Ğ¾ĞºĞ° Ñ‡Ñ‚Ğ¾ ÑĞ°Ğ¼ ÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ÑÑ Ğ½Ğµ Ğ¾Ñ‡ĞµĞ½ÑŒ ÑƒĞ¼Ğ½Ñ‹Ğ¼, Ñ‚Ğ°Ğº ĞºĞ°Ğº Ğ½Ğµ Ñ€ĞµĞ°Ğ³Ğ¸Ñ€ÑƒĞµÑ‚ Ğ½Ğ° Ğ¿Ğ¾Ğ²Ğ¾Ñ€Ğ¾Ñ‚Ñ‹.

### Ğ›Ğ¸ÑÑ‚Ğ¸Ğ½Ğ³ 2.2. Ğ˜Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ»Ğ¸Ğ½Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ.


```python
# Ğ¡Ñ‡Ğ¸Ñ‚Ğ°Ñ Ğ¿Ğ¾Ğ²Ñ‘Ñ€Ğ½ÑƒÑ‚Ñ‹Ğ¹ ÑˆÑ‚Ñ€Ğ¸Ñ… ĞºĞ¾Ğ´ Ğ² Ñ‡Ñ‘Ñ€Ğ½Ğ¾-Ğ±ĞµĞ»Ğ¾Ğ¼ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ.
image = cv2.cvtColor(cv2.imread("data/barcode_rotation.png"), cv2.COLOR_BGR2GRAY)
```


```python
# Ğ˜Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ»Ğ¸Ğ½Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ.
line = [400, 200, 50, 550] # y0, x0, y1, x1

# ĞŸĞ¾Ğ²Ñ‘Ñ€Ğ½ÑƒÑ‚Ñ‹Ğ¹ ÑˆÑ‚Ñ€Ğ¸Ñ… ĞºĞ¾Ğ´
if use_graph:
    figure(figsize=(32, 16), dpi=80)
    image_draw = cv2.imread("data/barcode_rotation.png")
    line_draw = line[::-1]
    image_draw = cv2.line(image_draw, tuple(line_draw[0:2]), tuple(line_draw[2:4]), color=(0, 0, 255), thickness=3)
    plt.imshow(cv2.cvtColor(image_draw, cv2.COLOR_BGR2RGB))
    plt.xticks([]),plt.yticks([])
    plt.show()
```


    
![png](output_10_0.png)
    



```python
# Ğ’Ñ‹Ğ²ĞµĞ´Ñƒ Ğ¿Ğ¾Ğ²Ñ‘Ñ€Ğ½ÑƒÑ‚Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ²Ğ´Ğ¾Ğ»ÑŒ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ»Ğ¸Ğ½Ğ¸Ğ¸.
if use_graph:
    figure(figsize=(16, 12), dpi=80)
    plt.plot(improfile(image, line))
```


    
![png](output_11_0.png)
    


ĞœĞ¾Ğ¶Ğ½Ğ¾ ÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ ÑˆÑ‚Ñ€Ğ¸Ñ… ĞºĞ¾Ğ´ Ğ´Ğ°Ğ¶Ğµ Ğ² Ğ¿Ğ¾Ğ²ĞµÑ€Ğ½ÑƒÑ‚Ğ¾Ğ¼ Ğ²Ğ¸Ğ´Ğµ. 
Ğ•ÑĞ»Ğ¸ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑÑ‚Ğ¾Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ ÑˆÑ‚Ñ€Ğ¸Ñ… ĞºĞ¾Ğ´Ğ° Ğ½Ğ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¸, Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ´Ğ°Ğ¶Ğµ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑ‚Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ.

### Ğ›Ğ¸ÑÑ‚Ğ¸Ğ½Ğ³ 2.3. ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ñ‚ĞµĞºÑÑ‚Ğ°

**ĞŸÑ€Ğ¾ĞµĞºÑ†Ğ¸Ñ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ**

ĞŸÑ€Ğ¾ĞµĞºÑ†Ğ¸ĞµĞ¹ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ½Ğ° Ğ½ĞµĞºĞ¾Ñ‚Ğ¾Ñ€ÑƒÑ Ğ¾ÑÑŒ Ğ½Ğ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ ÑÑƒĞ¼Ğ¼Ğ°Ğ¸Ğ½Ñ‚ĞµĞ½ÑĞ¸Ğ²Ğ½Ğ¾ÑÑ‚ĞµĞ¹ Ğ¿Ğ¸ĞºÑĞµĞ»ĞµĞ¹ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ² Ğ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğ¸, 
Ğ¿ĞµÑ€Ğ¿ĞµĞ½Ğ´Ğ¸ĞºÑƒĞ»ÑÑ€Ğ½Ğ¾Ğ¼ Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ¾ÑĞ¸. 

ĞŸÑ€Ğ¾ÑÑ‚ĞµĞ¹ÑˆĞ¸Ğ¼ ÑĞ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ğ¸ Ğ´Ğ²ÑƒĞ¼ĞµÑ€Ğ½Ğ¾Ğ³Ğ¾ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ ÑĞ²Ğ»ÑÑÑ‚ÑÑ Ğ²ĞµÑ€Ñ‚Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ñ 
Ğ½Ğ° Ğ¾ÑÑŒ ğ‘‚ğ‘¥, Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ÑÑÑ‰Ğ°Ñ ÑĞ¾Ğ±Ğ¾Ğ¹ ÑÑƒĞ¼Ğ¼Ñƒ Ğ¸Ğ½Ñ‚ĞµĞ½ÑĞ¸Ğ²Ğ½Ğ¾ÑÑ‚ĞµĞ¹ Ğ¿Ğ¸ĞºÑĞµĞ»ĞµĞ¹ Ğ¿Ğ¾ ÑÑ‚Ğ¾Ğ»Ğ±Ñ†Ğ°Ğ¼ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ:

Proj ğ‘‹(x) = sum(ğ¼(ğ‘¥,ğ‘¦) for y in range (0, len(ğ‘Œ)))

Ğ¸ Ğ³Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ñ Ğ½Ğ° Ğ¾ÑÑŒ ğ‘‚ğ‘¦, Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ÑÑÑ‰Ğ°Ñ ÑĞ¾Ğ±Ğ¾Ğ¹ ÑÑƒĞ¼Ğ¼Ñƒ Ğ¸Ğ½Ñ‚ĞµĞ½ÑĞ¸Ğ²Ğ½Ğ¾ÑÑ‚ĞµĞ¹ Ğ¿Ğ¸ĞºÑĞµĞ»ĞµĞ¹ Ğ¿Ğ¾ ÑÑ‚Ñ€Ğ¾ĞºĞ°Ğ¼ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ:

Proj Y(y) = sum(ğ¼(ğ‘¥,ğ‘¦) for x in range (0, len(X)))

Ğ—Ğ°Ğ¿Ğ¸ÑˆĞµĞ¼ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ğ¸ Ğ½Ğ° Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ»ÑŒĞ½ÑƒÑ Ğ¾ÑÑŒ. 
Ğ”Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼, Ñ‡Ñ‚Ğ¾ Ğ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾ÑĞ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¾ ĞµĞ´Ğ¸Ğ½Ğ¸Ñ‡Ğ½Ñ‹Ğ¼ Ğ²ĞµĞºÑ‚Ğ¾Ñ€Ğ¾Ğ¼ Ñ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ‚Ğ°Ğ¼Ğ¸ (ğ‘’ğ‘¥,ğ‘’ğ‘¦). 
Ğ¢Ğ¾Ğ³Ğ´Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ñ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ½Ğ° Ğ¾ÑÑŒ ğ‘‚ğ‘’ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ÑÑ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¼ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸ĞµĞ¼:

Proj E(t) = sum(ğ¼(ğ‘¥,ğ‘¦) for all i where x = ex * t + ey * i + and y = ey * t + ex * i)

ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ğ¸ Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµÑ‚ Ğ²Ñ‹Ğ´ĞµĞ»ÑÑ‚ÑŒ Ñ…Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ½Ñ‹Ğµ Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ğ¸, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒÑÑ‚ ĞºĞ¾Ğ½Ñ‚ÑƒÑ€Ğ°Ğ¼ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ²
Ğ½Ğ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¸. ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, ĞµÑĞ»Ğ¸ Ğ½Ğ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¸ Ğ¸Ğ¼ĞµÑÑ‚ÑÑ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ÑÑ‚Ğ½Ñ‹Ğµ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ñ‹, Ñ‚Ğ¾ Ğ² Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ğ¸ Ğ±ÑƒĞ´ÑƒÑ‚ Ğ²Ğ¸Ğ´Ğ½Ñ‹ Ğ¿ĞµÑ€ĞµĞ¿Ğ°Ğ´Ñ‹ Ğ¸Ğ»Ğ¸ 
ÑĞºÑÑ‚Ñ€ĞµĞ¼ÑƒĞ¼Ñ‹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸, ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¸Ğ· Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ².

ĞŸĞ¾Ğ´Ğ¾Ğ±Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ğ¸ Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğ² Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ°Ñ… Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ Ğ¸ ÑĞµĞ³Ğ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ğ¸ Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ñ… ÑÑ‚Ñ€Ğ¾Ğº Ğ² 
ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°Ñ… Ñ€Ğ°ÑĞ¿Ğ¾Ğ·Ğ½Ğ°Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚ĞµĞºÑÑ‚Ğ°.


```python
def calc_projection_X(image):
    image = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
    (thresh, image) = cv2.threshold(image, 128, 255, cv2.THRESH_BINARY | cv2.THRESH_OTSU)
    image -= np.min(image)
    max_intensity = np.max(image)
    vertical_pixel_sum = np.sum(max_intensity - image, axis=0)
    return vertical_pixel_sum

def calc_angle_projection(image, angle):
    image = 255 - image
    image_rotated = imutils.rotate_bound(image, angle)
    image_rotated = 255 - image_rotated
    return calc_projection_X(image_rotated)
```


```python
# Ğ¡Ñ‡Ğ¸Ñ‚Ğ°Ñ Ñ‚ĞµĞºÑÑ‚
image = cv2.imread("data/text_skew_inputs.png")
```


```python
# Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ñ Ğ½Ğ° Ğ¾ÑÑŒ Ox
angle_max = 0
if use_graph:
    figure(figsize=(32, 16), dpi=80)
    image_draw = image.copy()
    line_len = norm(np.array(image.shape)) / 2.0
    line = [image.shape[1] / 2.0 - cos(angle_max * pi / 180) * line_len,
            image.shape[0] / 2.0 - sin(-angle_max * pi / 180) * line_len, 
            image.shape[1] / 2.0 + cos(angle_max * pi / 180) * line_len,
            image.shape[0] / 2.0 + sin(-angle_max * pi / 180) * line_len]
    line = np.array(line, dtype="int64")
    image_draw = cv2.line(image_draw, tuple(line[0:2]), tuple(line[2:4]), color=(0, 0, 255), thickness=3)
    plt.imshow(cv2.cvtColor(image_draw, cv2.COLOR_BGR2RGB))
    plt.xticks([]),plt.yticks([])
    plt.show()
```


    
![png](output_17_0.png)
    



```python
if use_graph:
    figure(figsize=(16, 12), dpi=80)
    plt.plot(calc_angle_projection(image, angle_max))
```


    
![png](output_18_0.png)
    



```python
# Ğ¡Ñ‡Ğ¸Ñ‚Ğ°Ñ Ñ‚ĞµĞºÑÑ‚
image = cv2.imread("data/text_skew_inputs.png")
```


```python
# Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ñ Ğ½Ğ° Ğ¾ÑÑŒ Oy
angle_max = 90
if use_graph:
    figure(figsize=(32, 16), dpi=80)
    image_draw = image.copy()
    line_len = norm(np.array(image.shape)) / 2.0
    line = [image.shape[1] / 2.0 - cos(angle_max * pi / 180) * line_len,
            image.shape[0] / 2.0 - sin(-angle_max * pi / 180) * line_len, 
            image.shape[1] / 2.0 + cos(angle_max * pi / 180) * line_len,
            image.shape[0] / 2.0 + sin(-angle_max * pi / 180) * line_len]
    line = np.array(line, dtype="int64")
    image_draw = cv2.line(image_draw, tuple(line[0:2]), tuple(line[2:4]), color=(0, 0, 255), thickness=3)
    plt.imshow(cv2.cvtColor(image_draw, cv2.COLOR_BGR2RGB))
    plt.xticks([]),plt.yticks([])
    plt.show()
```


    
![png](output_20_0.png)
    



```python
if use_graph:
    figure(figsize=(16, 12), dpi=80)
    plt.plot(calc_angle_projection(image, angle_max))
```


    
![png](output_21_0.png)
    


Ğ˜Ğ· Ğ¿Ñ€ĞµĞ¾ĞºÑ†Ğ¸Ğ¸ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ²Ñ‹Ğ²Ğ¾Ğ´, Ñ‡Ñ‚Ğ¾ Ñ‚ĞµĞºÑÑ‚Ğ° 4, Ğ¸ Ğ¾Ğ½Ğ¸ Ğ½Ğ°Ñ…Ğ¾Ğ´ÑÑ‚ÑÑ Ğ¿Ğ¾ 4 ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ñ‹ Ğ¾Ñ‚ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ. 


```python
# Ğ¡Ñ‡Ğ¸Ñ‚Ğ°Ñ Ğ¿Ğ¾Ğ²Ñ‘Ñ€Ğ½ÑƒÑ‚Ñ‹Ğ¹ Ñ‚ĞµĞºÑÑ‚
image = cv2.imread("data/rotatedtext.jpg")
```


```python
# Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ†Ğ¸Ñ Ğ½Ğ° Ğ¾ÑÑŒ, Ğ¿ĞµÑ€Ğ¿ĞµĞ½Ğ´Ğ¸ĞºÑƒĞ»ÑÑ€Ğ½ÑƒÑ Ğ¾ÑĞ¸ Ñ‚ĞµĞºÑÑ‚Ğ°
angle_max = -45
if use_graph:
    figure(figsize=(32, 16), dpi=80)
    image_draw = image.copy()
    line_len = norm(np.array(image.shape)) / 2.0
    line = [image.shape[1] / 2.0 - cos(angle_max * pi / 180) * line_len,
            image.shape[0] / 2.0 - sin(-angle_max * pi / 180) * line_len, 
            image.shape[1] / 2.0 + cos(angle_max * pi / 180) * line_len,
            image.shape[0] / 2.0 + sin(-angle_max * pi / 180) * line_len]
    line = np.array(line, dtype="int64")
    image_draw = cv2.line(image_draw, tuple(line[0:2]), tuple(line[2:4]), color=(0, 0, 255), thickness=3)
    plt.imshow(cv2.cvtColor(image_draw, cv2.COLOR_BGR2RGB))
    plt.xticks([]),plt.yticks([])
    plt.show()
```


    
![png](output_24_0.png)
    



```python
if use_graph:
    figure(figsize=(16, 12), dpi=80)
    plt.plot(calc_angle_projection(image, angle_max))
```


    
![png](output_25_0.png)
    


ĞŸĞ¾ ĞµĞ´Ğ¸Ğ½Ğ¸Ñ‡Ğ½Ğ¾Ğ¼Ñƒ Ğ¿Ğ¸ĞºÑƒ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ²Ñ‹Ğ²Ğ¾Ğ´ Ğ¾ Ğ¼ĞµÑÑ‚Ğ¾Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸ Ñ‚ĞµĞºÑÑ‚Ğ°.

